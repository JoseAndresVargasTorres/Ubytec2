<div class="container">
  <div class="main-container">
    <div class="main">
      <div class="form-wrapper">
        <div class="container mt-4">
          <h2 class="text-center mb-4">Solicitud de Afiliación</h2>

          <!-- Sección de información del comercio -->
          <div class="form-section">
            <div class="form-group mb-3">
              <label for="cedula_Juridica" class="form-label">Número de Cédula Jurídica</label>
              <input
                type="text"
                class="form-control"
                id="cedula_Juridica"
                name="cedula_Juridica"
                [(ngModel)]="formData.cedula_Juridica"
                required
                placeholder="Ingrese la cédula jurídica"
              >
            </div>

            <div class="form-group mb-3">
              <label for="nombre" class="form-label">Nombre del Comercio</label>
              <input
                type="text"
                class="form-control"
                id="nombre"
                name="nombre"
                [(ngModel)]="formData.nombre"
                required
                placeholder="Ingrese el nombre del comercio"
              >
            </div>

            <div class="form-group mb-3">
              <label for="id_Tipo" class="form-label">Tipo de Comercio</label>
              <div *ngIf="loading" class="spinner-border spinner-border-sm" role="status">
                <span class="visually-hidden">Cargando...</span>
              </div>

              <select
                class="form-select"
                id="id_Tipo"
                name="id_Tipo"
                [(ngModel)]="formData.id_Tipo"
                required
                [disabled]="loading"
              >
                <option value="">Seleccione un tipo de comercio</option>
                <option *ngFor="let tipo of tiposComercio" [value]="tipo.id">
                  {{tipo.nombre}}
                </option>
              </select>

              <div *ngIf="errorCarga" class="alert alert-danger mt-2">
                Error al cargar los tipos de comercio. Por favor, intente nuevamente.
              </div>
            </div>
          </div>

          <!-- Botón para gestionar administrador -->
          <div class="form-section">
            <button
              type="button"
              class="btn btn-primary mb-3"
              (click)="openAdminDialog()"
            >
              Gestionar Administrador
            </button>

            <div *ngIf="adminAdded" class="alert alert-success">
              Administrador agregado con éxito.
            </div>
          </div>

          <!-- Sección de dirección -->
          <!-- Reemplazar la sección de dirección existente con esto -->
          <div class="form-section">
            <h3 class="section-title">Dirección</h3>
            <div class="row g-3">
              <div class="col-md-4">
                <div class="form-group">
                  <label for="provincia" class="form-label">Provincia</label>
                  <select
                    class="form-select"
                    id="provincia"
                    name="provincia"
                    [(ngModel)]="formData.provincia"
                    required
                  >
                    <option value="">Seleccione una provincia</option>
                    <option *ngFor="let provincia of provincias" [value]="provincia">
                      {{provincia}}
                    </option>
                  </select>
                </div>
              </div>

              <div class="col-md-4">
                <div class="form-group">
                  <label for="canton" class="form-label">Cantón</label>
                  <input
                    type="text"
                    class="form-control"
                    id="canton"
                    name="canton"
                    [(ngModel)]="formData.canton"
                    required
                    placeholder="Ingrese el cantón"
                  >
                </div>
              </div>

              <div class="col-md-4">
                <div class="form-group">
                  <label for="distrito" class="form-label">Distrito</label>
                  <input
                    type="text"
                    class="form-control"
                    id="distrito"
                    name="distrito"
                    [(ngModel)]="formData.distrito"
                    required
                    placeholder="Ingrese el distrito"
                  >
                </div>
              </div>
            </div>
          </div>

          <!-- Sección de teléfonos -->
          <div class="form-section">
            <h3 class="section-title">Teléfonos</h3>
            <div class="phone-list">
              <div class="phone-item" *ngFor="let phone of phones; let i = index; trackBy: trackByIndex">
                <div class="input-group mb-2">
                  <input
                    type="text"
                    class="form-control"
                    [(ngModel)]="phones[i]"
                    placeholder="Ingrese el teléfono"
                    required
                  >
                  <button
                    class="btn btn-danger"
                    type="button"
                    (click)="removePhone(i)"
                    [disabled]="phones.length === 1"
                  >
                    Eliminar
                  </button>
                </div>
              </div>
            </div>
            <button
              type="button"
              class="btn btn-secondary mb-3"
              (click)="addPhone()"
            >
              Añadir Teléfono
            </button>
          </div>

          <!-- Sección de contacto -->
          <div class="form-section">
            <div class="form-group mb-3">
              <label for="correo" class="form-label">Correo electrónico</label>
              <input
                type="email"
                class="form-control"
                id="correo"
                name="correo"
                [(ngModel)]="formData.correo"
                required
                placeholder="Ingrese el correo electrónico"
              >
            </div>

            <div class="form-group mb-3">
              <label for="sinpe" class="form-label">Número de SINPE móvil</label>
              <input
                type="text"
                class="form-control"
                id="sinpe"
                name="sinpe"
                [(ngModel)]="formData.sinpe"
                required
                placeholder="Ingrese el número SINPE"
              >
            </div>
          </div>

          <!-- Botón de registro -->
          <div class="form-section text-center">
            <button
              type="submit"
              class="btn btn-success btn-lg"
              (click)="submit(formData)"
              [disabled]="!adminAdded"
            >
              Registrar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
